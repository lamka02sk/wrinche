componentList=[];selectors=document.querySelectorAll("div.component-element");for(let i=0;i<selectors.length;++i){componentList.push(selectors[i].getAttribute("data-component"))}if(typeof componentsModule==="undefined"){let element=document.createElement("script");element.setAttribute("type","text/javascript");element.setAttribute("src","app/Components/Components.min.js");element.onload=function(){componentsModule.start(componentList)};body.appendChild(element)}else{componentsModule.start(componentList)}previousScripts.push("write");initializePasswordToggle();packery=$("div.content-settings").packery({itemSelector:"div.component-element",gutter:22});tmp=document.querySelector("div.content-builder-content");if(tmp){sortable=Sortable.create(tmp,{sort:true,animation:200,scroll:true,draggable:".component-element",handle:".component-inline-drag",onChoose:function(){let elements=document.querySelectorAll("div.component-placeholder");elements.forEach(function(a){a.classList.remove("hide")})},onStart:function(a){let identifier=a.item.attributes["data-id"].value;if(CKEDITOR.instances["editor_"+identifier]){CKEDITOR.instances["editor_"+identifier].destroy()}},onEnd:function(a){let element=a.item;let identifier=element.attributes["data-id"].value;let component=element.attributes["data-component"].value;if(component in componentsModule.modules){if("reload" in componentsModule.modules[component]){componentsModule.modules[component].reload(identifier)}}let elements=document.querySelectorAll("div.component-placeholder");elements.forEach(function(b){b.classList.add("hide")})}})}tmp=undefined;contentElement=document.querySelector("div.content-wrapper");$("span.collapse-trigger").click(function(a){a.target.parentNode.parentNode.parentNode.classList.toggle("open");packery.packery().reloadItems()});document.querySelectorAll("div.builder-tools button.add-content").forEach(function(a){a.addEventListener("click",function(b){let component=b.target.getAttribute("data-content");componentsModule.createComponent(component)})});selector=new Selector({selector:"select.selector-search-select"});initDatePicker();function componentsOrder(){let components=document.querySelector(".content-builder-content"),order=[];for(let i=0;i<components.children.length;++i){if(!components.children[i].getAttribute("data-id")){return false}order.push(components.children[i].getAttribute("data-id"))}return order}document.querySelector(".save-content").addEventListener("click",function(){let valid=componentsModule.validate();if(!valid){return false}let articleID=contentElement.getAttribute("data-id");let componentsData=componentsModule.serialize();let order=componentsOrder();let data={action:0,type:contentElement.getAttribute("data-type"),order:order,components:componentsData};if(articleID!==""){data.articleID=articleID}postData(URI+"write",data,function(b,a){b=JSON.parse(b);if(b.article_id){contentElement.setAttribute("data-id",b.article_id)}})});initializeCounters();$("div.splash").addClass("done");