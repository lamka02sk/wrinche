var validate={username:function(d){if(d.trim().length<4){return"USERNAME_SHORT"}if(d.trim().length>25){return"USERNAME_LONG"}if(/\s/g.test(d)){return"USERNAME_SPACES"}var c=/^([a-zA-Z0-9]+)$/;if(!c.test(d)){return"USERNAME_REGEX"}return true},mail:function(d){if(/\s/g.test(d)){return"EMAIL_SPACES"}var c=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(!c.test(d)){return"EMAIL_INVALID"}return true},password:function(b){if(b.trim().length<8){return"PASSWORD_SHORT"}if(b.trim().length>45){return"PASSWORD_LONG"}if(/\s/g.test(b)){return"PASSWORD_SPACES"}if(b.match(/\d/g)===null){return"PASSWORD_NUMBER"}return true},match:function(d){var c=$("input[name=password]").val();if(c!==d){return"PASSWORD_MATCH"}return true},name:function(b){if(b.trim().length<1){return"NAME_SHORT"}if(b.trim().length>45){return"NAME_LONG"}return true},description:function(b){if(b.trim().length<6){return"DESC_SHORT"}if(b.trim().length>120){return"DESC_LONG"}return true}};function pushMessage(d,c){d.parent().find("label").removeClass("valid").addClass("error");d.parent().find("p.message").text(c).addClass("active")}function removeMessage(b){b.parent().find("label").removeClass("error").addClass("valid");b.parent().find("p.message").removeClass("active").text("")}function processValidation(l,h){var j=l.parent().parent().parent().parent().data("id");var m=l.attr("name");var i=l.val();if(j===2){var n=validate[m](i);if(typeof(n)==="string"){pushMessage(l,h[n]);return false}else{removeMessage(l);return true}}else{var k=l.attr("type");if(k==="checkbox"&&l.attr("name")==="eula"){if(!l.prop("checked")){pushMessage(l,h.EULA_CHECK);return false}else{removeMessage(l);return true}}if(m==="name"){n=validate.name(i);if(typeof(n)==="string"){pushMessage(l,h[n]);return false}else{removeMessage(l);return true}}if(m==="description"){n=validate.description(i);if(typeof(n)==="string"){pushMessage(l,h[n]);return false}else{removeMessage(l);return true}}if(i&&i.trim()){removeMessage(l);return true}else{pushMessage(l,h.INPUT_EMPTY);return false}}}function validateForm(f,e){var d=true;$("div.install-form[data-id="+f+"] div.form-input").each(function(){if(!$(this).hasClass("form-select")){var a=$(this).find("input");if(!processValidation(a,e)){d=false}}});return d}function checkConnection(g){var h,j,f,i;h=$("input[name=dbhost]").val();j=$("input[name=dbname]").val();f=$("input[name=dbuser]").val();i=$("input[name=dbpass]").val();$.ajax({type:"POST",url:"dbTest.php",data:{dbhost:h,dbname:j,dbuser:f,dbpass:i,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,async:false,success:function(a){if(a==="true"){$("p.connection-message").removeClass("fail").addClass("success").text(g.CONNECTION_SUCCESS)}else{$("p.connection-message").removeClass("success").addClass("fail").text(g.CONNECTION_ERROR)}},error:function(){$("p.connection-message").removeClass("success").addClass("fail").text(g.SERVER_ERROR)}})}var locale;$(document).ready(function(){translate("install");$("div.intro").addClass("animate");$("button.proceed-install").delay(500).queue(function(){$(this).addClass("animate").dequeue()}).click(function(){$("div.intro").addClass("hide").removeClass("animate");$("div.installer").addClass("animate")});var d=[];$("button.next-step").click(function(){var b=[2,3,4];var c=$(this).parent().parent();var a=c.data("id");var h=+a+1;d[a]=$(this).prev().serializeArray();if(jQuery.inArray(a,b)!==-1){if(!validateForm(a,locale)){return false}}if(a===3){checkConnection(locale);if($("p.connection-message").hasClass("fail")){return false}}if(a!==4){$("div.install-form").removeClass("active");$("div.install-form[data-id="+h+"]").addClass("active");$(".menu-box ol li").removeClass("active");$(".menu-box ol li[data-id="+a+"]").addClass("done");$(".menu-box ol li[data-id="+h+"]").addClass("active")}else{$("div.installer").removeClass("animate");$("div.installing").addClass("show");$.ajax({type:"POST",url:"index.php",data:{installer:d,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,async:true,success:function(g){g=JSON.parse(g);$("div.installing").removeClass("show").addClass("hide");if(g.success!==true){$("div.install-error").addClass("show")}else{$("div.installed").addClass("show");$("p[data-locale=DONE_ADMIN]").append(" "+g.admin)}},error:function(){$("div.installing").removeClass("show").addClass("hide");$("div.install-error").addClass("show")}});d=[]}});$("input").on("change keydown keypress keyup mousedown click mouseup focusout",function(){if($(this).is("checkbox")){return}var a=$(this);processValidation(a,locale)});$("button.test-connection").click(function(){checkConnection(locale)});$("label.checkbox").click(function(){var a=$(this).parent().find("input");if(a.is(":checked")){a.prop("checked",false)}else{a.prop("checked",true)}});$("#selector_language .selector-options .selector-option").click(function(){var b=$("html").attr("lang");var a=$(this).data("value");if(b===a){return}var c="ENGLISH";if(a==="sk"){c="SLOVAK"}$(this).parent().parent().find(".selector-selected").attr("data-locale",c);locale=changeLanguage(a,"install")});$("#selector_theme .selector-options .selector-option").click(function(){var a=$(this).data("value");if(f===a){return}changeTheme(a,"installation");f=a});$("button.try-again").click(function(){$("div.installing, div.installed, div.install-error").removeClass("show");$("div.install-form").removeClass("active");$("div.install-form[data-id=1]").addClass("active");$("div.intro").removeClass("hide").addClass("animate");$("div.menu-box ol li").removeClass();$("div.menu-box ol li[data-id=1]").addClass("active")});var f="light";var e=new Date();if((e.getHours()>=18)||(e.getHours()<8)){changeTheme("dark","installation");f="dark";document.querySelector("button[data-value=dark]").click()}});