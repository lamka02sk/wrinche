var validate={username:function(a){if(a.trim().length<4){return"USERNAME_SHORT"}if(a.trim().length>25){return"USERNAME_LONG"}if(/\s/g.test(a)){return"USERNAME_SPACES"}var b=/^([a-zA-Z0-9]+)$/;if(!b.test(a)){return"USERNAME_REGEX"}return true},mail:function(a){if(/\s/g.test(a)){return"EMAIL_SPACES"}var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(!b.test(a)){return"EMAIL_INVALID"}return true},password:function(a){if(a.trim().length<8){return"PASSWORD_SHORT"}if(a.trim().length>45){return"PASSWORD_LONG"}if(/\s/g.test(a)){return"PASSWORD_SPACES"}if(a.match(/\d/g)===null){return"PASSWORD_NUMBER"}return true},match:function(a){var b=$("input[name=password]").val();if(b!==a){return"PASSWORD_MATCH"}return true},name:function(a){if(a.trim().length<1){return"NAME_SHORT"}if(a.trim().length>45){return"NAME_LONG"}return true},description:function(a){if(a.trim().length<6){return"DESC_SHORT"}if(a.trim().length>120){return"DESC_LONG"}return true}};function pushMessage(a,b){a.parent().find("label").removeClass("valid").addClass("error");a.parent().find("p.message").text(b).addClass("active")}function removeMessage(a){a.parent().find("label").removeClass("error").addClass("valid");a.parent().find("p.message").removeClass("active").text("")}function processValidation(e,b){var g=e.parent().parent().parent().parent().data("id");var d=e.attr("name");var a=e.val();if(g===2){var c=validate[d](a);if(typeof(c)==="string"){pushMessage(e,b[c]);return false}else{removeMessage(e);return true}}else{var f=e.attr("type");if(f==="checkbox"&&e.attr("name")==="eula"){if(!e.prop("checked")){pushMessage(e,b.EULA_CHECK);return false}else{removeMessage(e);return true}}if(d==="name"){c=validate.name(a);if(typeof(c)==="string"){pushMessage(e,b[c]);return false}else{removeMessage(e);return true}}if(d==="description"){c=validate.description(a);if(typeof(c)==="string"){pushMessage(e,b[c]);return false}else{removeMessage(e);return true}}if(a&&a.trim()){removeMessage(e);return true}else{pushMessage(e,b.INPUT_EMPTY);return false}}}function validateForm(c,a){var b=true;$("div.install-form[data-id="+c+"] div.form-input").each(function(){if(!$(this).hasClass("form-select")){var d=$(this).find("input");if(!processValidation(d,a)){b=false}}});return b}function getJson(a){return JSON.parse($.ajax({type:"GET",url:a,dataType:"json",global:false,async:false,success:function(b){return b}}).responseText)}function checkConnection(a){var e,c,b,d;e=$("input[name=dbhost]").val();c=$("input[name=dbname]").val();b=$("input[name=dbuser]").val();d=$("input[name=dbpass]").val();$.ajax({type:"POST",url:"dbTest.php",data:{dbhost:e,dbname:c,dbuser:b,dbpass:d,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,success:function(f){if(f==="true"){$("p.connection-message").removeClass("fail").addClass("success").text(a.CONNECTION_SUCCESS);return true}else{$("p.connection-message").removeClass("success").addClass("fail").text(a.CONNECTION_ERROR);return false}},error:function(){$("p.connection-message").removeClass("success").addClass("fail").text(a.SERVER_ERROR);return false}})}$(document).ready(function(){var c=$("html").attr("lang");var a=getJson("app/Data/Locale/"+c+"/install.json");$("select").dropdown();$("div.intro").addClass("animate");$("button.proceed-install").delay(500).queue(function(){$(this).addClass("animate").dequeue()}).click(function(){$("div.intro").addClass("hide").removeClass("animate");$("div.installer").addClass("animate")});var b=[];$("button.next-step").click(function(){var f=[2,3,4];var e=$(this).parent().parent();var g=e.data("id");var d=+g+1;b[g]=$(this).prev().serializeArray();if(jQuery.inArray(g,f)!==-1){if(!validateForm(g,a)){return false}}if(g!==4){if(g===3){if(!checkConnection(a)){return false}}$("div.install-form").removeClass("active");$("div.install-form[data-id="+d+"]").addClass("active");$(".menu-box ol li").removeClass("active");$(".menu-box ol li[data-id="+g+"]").addClass("done");$(".menu-box ol li[data-id="+d+"]").addClass("active")}else{}});$("input").on("change keydown keypress keyup mousedown click mouseup focusout",function(){var d=$(this);processValidation(d,a)});$("button.test-connection").click(function(){checkConnection(a)})});