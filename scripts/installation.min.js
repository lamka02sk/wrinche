var validate={username:function(a){if(a.trim().length<4){return"USERNAME_SHORT"}if(a.trim().length>25){return"USERNAME_LONG"}if(/\s/g.test(a)){return"USERNAME_SPACES"}var b=/^([a-zA-Z0-9]+)$/;if(!b.test(a)){return"USERNAME_REGEX"}return true},mail:function(a){if(/\s/g.test(a)){return"EMAIL_SPACES"}var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(!b.test(a)){return"EMAIL_INVALID"}return true},password:function(a){if(a.trim().length<8){return"PASSWORD_SHORT"}if(a.trim().length>45){return"PASSWORD_LONG"}if(/\s/g.test(a)){return"PASSWORD_SPACES"}if(a.match(/\d/g)===null){return"PASSWORD_NUMBER"}return true},match:function(a){var b=$("input[name=password]").val();if(b!==a){return"PASSWORD_MATCH"}return true},name:function(a){if(a.trim().length<1){return"NAME_SHORT"}if(a.trim().length>45){return"NAME_LONG"}return true},description:function(a){if(a.trim().length<6){return"DESC_SHORT"}if(a.trim().length>120){return"DESC_LONG"}return true}};function pushMessage(a,b){a.parent().find("label").removeClass("valid").addClass("error");a.parent().find("p.message").text(b).addClass("active")}function removeMessage(a){a.parent().find("label").removeClass("error").addClass("valid");a.parent().find("p.message").removeClass("active").text("")}function processValidation(e,b){var g=e.parent().parent().parent().parent().data("id");var d=e.attr("name");var a=e.val();if(g===2){var c=validate[d](a);if(typeof(c)==="string"){pushMessage(e,b[c]);return false}else{removeMessage(e);return true}}else{var f=e.attr("type");if(f==="checkbox"&&e.attr("name")==="eula"){if(!e.prop("checked")){pushMessage(e,b.EULA_CHECK);return false}else{removeMessage(e);return true}}if(d==="name"){c=validate.name(a);if(typeof(c)==="string"){pushMessage(e,b[c]);return false}else{removeMessage(e);return true}}if(d==="description"){c=validate.description(a);if(typeof(c)==="string"){pushMessage(e,b[c]);return false}else{removeMessage(e);return true}}if(a&&a.trim()){removeMessage(e);return true}else{pushMessage(e,b.INPUT_EMPTY);return false}}}function validateForm(c,a){var b=true;$("div.install-form[data-id="+c+"] div.form-input").each(function(){if(!$(this).hasClass("form-select")){var d=$(this).find("input");if(!processValidation(d,a)){b=false}}});return b}function getJson(a){return JSON.parse($.ajax({type:"GET",url:a,dataType:"json",global:false,async:false,success:function(b){return b}}).responseText)}function checkConnection(a){var e,c,b,d;e=$("input[name=dbhost]").val();c=$("input[name=dbname]").val();b=$("input[name=dbuser]").val();d=$("input[name=dbpass]").val();$.ajax({type:"POST",url:"dbTest.php",data:{dbhost:e,dbname:c,dbuser:b,dbpass:d,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,async:false,success:function(f){if(f==="true"){$("p.connection-message").removeClass("fail").addClass("success").text(a.CONNECTION_SUCCESS)}else{$("p.connection-message").removeClass("success").addClass("fail").text(a.CONNECTION_ERROR)}},error:function(){$("p.connection-message").removeClass("success").addClass("fail").text(a.SERVER_ERROR)}})}var locale;$(document).ready(function(){var d=$("html").attr("lang");locale=getJson("app/Data/Locale/"+d+"/install.json");changeLanguage(d,"install",locale);$("div.intro").addClass("animate");$("button.proceed-install").delay(500).queue(function(){$(this).addClass("animate").dequeue()}).click(function(){$("div.intro").addClass("hide").removeClass("animate");$("div.installer").addClass("animate")});var b=[];$("button.next-step").click(function(){var g=[2,3,4];var f=$(this).parent().parent();var h=f.data("id");var e=+h+1;b[h]=$(this).prev().serializeArray();if(jQuery.inArray(h,g)!==-1){if(!validateForm(h,locale)){return false}}if(h===3){checkConnection(locale);if($("p.connection-message").hasClass("fail")){return false}}if(h!==4){$("div.install-form").removeClass("active");$("div.install-form[data-id="+e+"]").addClass("active");$(".menu-box ol li").removeClass("active");$(".menu-box ol li[data-id="+h+"]").addClass("done");$(".menu-box ol li[data-id="+e+"]").addClass("active")}else{$("div.installer").removeClass("animate");$("div.installing").addClass("show");$.ajax({type:"POST",url:"index.php",data:{installer:b,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,async:true,success:function(i){i=JSON.parse(i);$("div.installing").removeClass("show").addClass("hide");if(i.success!==true){$("div.install-error").addClass("show")}else{$("div.installed").addClass("show");$("p[data-locale=DONE_ADMIN]").append(": "+i.admin)}},error:function(){$("div.installing").removeClass("show").addClass("hide");$("div.install-error").addClass("show")}});b=[]}});$("input").on("change keydown keypress keyup mousedown click mouseup focusout",function(){if($(this).is("checkbox")){return}var e=$(this);processValidation(e,locale)});$("button.test-connection").click(function(){checkConnection(locale)});$("label.checkbox").click(function(){var e=$(this).parent().find("input");if(e.is(":checked")){e.prop("checked",false)}else{e.prop("checked",true)}});$("#selector_language .selector-options .selector-option").click(function(){var f=$("html").attr("lang");var g=$(this).data("value");if(f===g){return}var e="ENGLISH";if(g==="sk"){e="SLOVAK"}$(this).parent().parent().find(".selector-selected").attr("data-locale",e);locale=changeLanguage(g,"install")});$("#selector_theme .selector-options .selector-option").click(function(){var e=$(this).data("value");if(c===e){return}changeTheme(e,"installation");c=e});$("button.try-again").click(function(){$("div.installing, div.installed, div.install-error").removeClass("show");$("div.install-form").removeClass("active");$("div.install-form[data-id=1]").addClass("active");$("div.intro").removeClass("hide").addClass("animate");$("div.menu-box ol li").removeClass();$("div.menu-box ol li[data-id=1]").addClass("active")});var c="light";var a=new Date();if((a.getHours()>=18)||(a.getHours()<8)){changeTheme("dark","installation");c="dark";document.querySelector("button[data-value=dark]").click()}});