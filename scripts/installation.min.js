function pushMessage(a,b){a.parent().find("label").removeClass("valid").addClass("error");a.parent().find("p.message").text(b).addClass("active")}function popMessage(a){a.parent().find("label").removeClass("error").addClass("valid");a.parent().find("p.message").removeClass("active").text("")}function processValidation(b,a){let formId=b.parent().parent().parent().parent().data("id");let inputName=b.attr("name");let inputValue=b.val();let validationResult;let validate=new Validator;if(formId===2){validationResult=validate[inputName](inputValue);if(typeof(validationResult)==="string"){pushMessage(b,a.validate[validationResult]);return false}else{popMessage(b);return true}}else{let inputType=b.attr("type");if(inputType==="checkbox"&&b.attr("name")==="eula"){if(!b.prop("checked")){pushMessage(b,a.validate["EULA_CHECK"]);return false}else{popMessage(b);return true}}if(inputName==="name"){validationResult=validate.name(inputValue);if(typeof(validationResult)==="string"){pushMessage(b,a.validate[validationResult]);return false}else{popMessage(b);return true}}if(inputName==="description"){validationResult=validate.description(inputValue);if(typeof(validationResult)==="string"){pushMessage(b,a.validate[validationResult]);return false}else{popMessage(b);return true}}if(inputValue&&inputValue.trim()){popMessage(b);return true}else{pushMessage(b,a.validate["INPUT_EMPTY"]);return false}}}function validateForm(b,a){let valid=true;$("div.install-form[data-id="+b+"] div.form-input").each(function(){if(!$(this).hasClass("form-select")){let element=$(this).find("input");if(!processValidation(element,a)){valid=false}}});return valid}function checkConnection(a){let host,name,user,pass;host=$("input[name=dbhost]").val();name=$("input[name=dbname]").val();user=$("input[name=dbuser]").val();pass=$("input[name=dbpass]").val();$.ajax({type:"POST",url:"dbTest.php",data:{dbhost:host,dbname:name,dbuser:user,dbpass:pass,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,async:false,success:function(b){if(b==="true"){$("p.connection-message").removeClass("fail").addClass("success").text(a.install["CONNECTION_SUCCESS"])}else{$("p.connection-message").removeClass("success").addClass("fail").text(a.install["CONNECTION_ERROR"])}},error:function(){$("p.connection-message").removeClass("success").addClass("fail").text(a.install["SERVER_ERROR"])}})}let locale;$(document).ready(function(){let translate=new Translate(["controls","system","validate","install"],"install");locale=translate.getLocale();let language=translate.getLanguage();$("button.selector-option[data-value="+language+"]").click();$("div.intro").addClass("animate");$("button.proceed-install").delay(500).queue(function(){$(this).addClass("animate").dequeue()}).click(function(){$("div.intro").addClass("hide").removeClass("animate");$("div.installer").addClass("animate")});let formsData=[];$("button.next-step").click(function(){let formsToValidate=[2,3,4];let formElement=$(this).parent().parent();let formId=formElement.data("id");let nextForm=+formId+1;formsData[formId]=$(this).prev().serializeArray();if(jQuery.inArray(formId,formsToValidate)!==-1){if(!validateForm(formId,locale)){return false}}if(formId===3){checkConnection(locale);if($("p.connection-message").hasClass("fail")){return false}}if(formId!==4){$("div.install-form").removeClass("active");$("div.install-form[data-id="+nextForm+"]").addClass("active");$(".menu-box ol li").removeClass("active");$(".menu-box ol li[data-id="+formId+"]").addClass("done");$(".menu-box ol li[data-id="+nextForm+"]").addClass("active")}else{$("div.installer").removeClass("animate");$("div.installing").addClass("show");$.ajax({type:"POST",url:"index.php",data:{installer:formsData,csrf_token:$("meta[name=csrf_token]").attr("content")},contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:false,async:true,success:function(a){a=JSON.parse(a);$("div.installing").removeClass("show").addClass("hide");if(a.success!==true){$("div.install-error").addClass("show")}else{$("div.installed").addClass("show");$("p[data-locale=DONE_ADMIN]").append(" "+a.admin)}},error:function(){$("div.installing").removeClass("show").addClass("hide");$("div.install-error").addClass("show")}});formsData=[]}});$("input").on("change keydown keypress keyup mousedown click mouseup focusout",function(){if($(this).is("checkbox")){return false}let element=$(this);processValidation(element,locale)});$("button.test-connection").click(function(){checkConnection(locale)});$("label.checkbox").click(function(){let input=$(this).parent().find("input");if(input.is(":checked")){input.prop("checked",false)}else{input.prop("checked",true)}});$("#selector_language .selector-options .selector-option").click(function(){let currentLanguage=$("html").attr("lang");let language=$(this).data("value");if(currentLanguage===language){return false}let lc="ENGLISH";if(language==="sk"){lc="SLOVAK"}$(this).parent().parent().find(".selector-selected").attr("data-locale",lc);localStorage.setItem("locale_install",language);let translate=new Translate(["controls","system","install","validate"],"install");locale=translate.getLocale()});$("#selector_theme .selector-options .selector-option").click(function(){let theme=$(this).data("value");if(currentTheme===theme){return false}changeTheme(theme,"installation");currentTheme=theme});$("button.try-again").click(function(){$("div.installing, div.installed, div.install-error").removeClass("show");$("div.install-form").removeClass("active");$("div.install-form[data-id=1]").addClass("active");$("div.intro").removeClass("hide").addClass("animate");$("div.menu-box ol li").removeClass();$("div.menu-box ol li[data-id=1]").addClass("active")});let currentTheme="light";let date=new Date();if((date.getHours()>=18)||(date.getHours()<8)){changeTheme("dark","installation");currentTheme="dark";document.querySelector("button[data-value=dark]").click()}});