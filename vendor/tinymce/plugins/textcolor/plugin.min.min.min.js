tinymce.PluginManager.add("textcolor",function(n){function e(b){var c;return n.dom.getParents(n.selection.getStart(),function(d){var f;(f=d.style["forecolor"==b?"color":"background-color"])&&(c=f)}),c}function r(d){var f,c,b=[];for(c=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],c=n.settings.textcolor_map||c,c=n.settings[d+"_map"]||c,f=0;f<c.length;f+=2){b.push({text:c[f+1],color:"#"+c[f]})}return b}function t(){function d(v,u){var w="transparent"==v;return'<td class="mce-grid-cell'+(w?" mce-colorbtn-trans":"")+'"><div id="'+C+"-"+b+++'" data-mce-color="'+(v?v:"")+'" role="option" tabIndex="-1" style="'+(v?"background-color: "+v:"")+'" title="'+tinymce.translate(u)+'">'+(w?"&#215;":"")+"</div></td>"}var h,D,f,j,c,k,m,p,g=this,C=g._id,b=0;for(p=g.settings.origin,h=r(p),h.push({text:tinymce.translate("No color"),color:"transparent"}),f='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',j=h.length-1,k=0;k<i[p];k++){for(f+="<tr>",c=0;c<q[p];c++){m=k*q[p]+c,m>j?f+="<td></td>":(D=h[m],f+=d(D.color,D.text))}f+="</tr>"}if(n.settings.color_picker_callback){for(f+='<tr><td colspan="'+q[p]+'" class="mce-custom-color-btn"><div id="'+C+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+C+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>",f+="<tr>",c=0;c<q[p];c++){f+=d("","Custom color")}f+="</tr>"}return f+="</tbody></table>"}function o(b,c){n.undoManager.transact(function(){n.focus(),n.formatter.apply(b,{value:c}),n.nodeChanged()})}function s(b){n.undoManager.transact(function(){n.focus(),n.formatter.remove(b,{value:null},null,!0),n.nodeChanged()})}function l(c){function j(k){g.hidePanel(),g.color(k),o(g.settings.format,k)}function h(){g.hidePanel(),g.resetColor(),s(g.settings.format)}function b(m,k){m.style.background=k,m.setAttribute("data-mce-color",k)}var f,d,g=this.parent();d=g.settings.origin,tinymce.DOM.getParent(c.target,".mce-custom-color-btn")&&(g.hidePanel(),n.settings.color_picker_callback.call(n,function(v){var x,m,k,p=g.panel.getEl().getElementsByTagName("table")[0];for(x=tinymce.map(p.rows[p.rows.length-1].childNodes,function(u){return u.firstChild}),k=0;k<x.length&&(m=x[k],m.getAttribute("data-mce-color"));k++){}if(k==q[d]){for(k=0;k<q[d]-1;k++){b(x[k],x[k+1].getAttribute("data-mce-color"))}}b(m,v),j(v)},e(g.settings.format))),f=c.target.getAttribute("data-mce-color"),f?(this.lastId&&document.getElementById(this.lastId).setAttribute("aria-selected",!1),c.target.setAttribute("aria-selected",!0),this.lastId=c.target.id,"transparent"==f?h():j(f)):null!==f&&g.hidePanel()}function a(){var b=this;b._color?o(b.settings.format,b._color):s(b.settings.format)}var q,i;i={forecolor:n.settings.forecolor_rows||n.settings.textcolor_rows||5,backcolor:n.settings.backcolor_rows||n.settings.textcolor_rows||5},q={forecolor:n.settings.forecolor_cols||n.settings.textcolor_cols||8,backcolor:n.settings.backcolor_cols||n.settings.textcolor_cols||8},n.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{origin:"forecolor",role:"application",ariaRemember:!0,html:t,onclick:l},onclick:a}),n.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{origin:"backcolor",role:"application",ariaRemember:!0,html:t,onclick:l},onclick:a})});