!function(g,d){function j(k,a){for(var m,i=[],l=0;l<k.length;++l){if(m=b[k[l]]||c(k[l]),!m){throw"module definition dependecy not found: "+k[l]}i.push(m)}a.apply(null,i)}function f(l,k,a){if("string"!=typeof l){throw"invalid module definition, module id must be defined and be a string"}if(k===d){throw"invalid module definition, dependencies must be specified"}if(a===d){throw"invalid module definition, definition function must be specified"}j(k,function(){b[l]=a.apply(null,arguments)})}function c(e){for(var l=g,k=e.split(/[.\/]/),a=0;a<k.length;++a){if(!l[k[a]]){return}l=l[k[a]]}return l}function h(t){var p,k,q,m,a;for(p=0;p<t.length;p++){k=g,q=t[p],m=q.split(/[.\/]/);for(var e=0;e<m.length-1;++e){k[m[e]]===d&&(k[m[e]]={}),k=k[m[e]]}k[m[m.length-1]]=b[q]}if(g.AMDLC_TESTS){a=g.privateModules||{};for(q in b){a[q]=b[q]}for(p=0;p<t.length;p++){delete a[t[p]]}g.privateModules=a}}var b={};f("tinymce/spellcheckerplugin/DomTextMatcher",[],function(){function a(i){return i&&1==i.nodeType&&"false"===i.contentEditable}return function(H,O){function K(k,i){if(!k[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}return{start:k.index,end:k.index+k[0].length,text:k[0],data:i}}function T(i){var k;if(3===i.nodeType){return i.data}if(q[i.nodeName]&&!G[i.nodeName]){return""}if(a(i)){return"\n"}if(k="",(G[i.nodeName]||ab[i.nodeName])&&(k+="\n"),i=i.firstChild){do{k+=T(i)}while(i=i.nextSibling)}return k}function M(S,p,k){var w,m,E,ac,v,N=[],C=0,y=S,x=0;p=p.slice(0),p.sort(function(l,i){return l.start-i.start}),v=p.shift();a:for(;;){if((G[y.nodeName]||ab[y.nodeName]||a(y))&&C++,3===y.nodeType&&(!m&&y.length+C>=v.end?(m=y,ac=v.end-C):w&&N.push(y),!w&&y.length+C>v.start&&(w=y,E=v.start-C),C+=y.length),w&&m){if(y=k({startNode:w,startNodeIndex:E,endNode:m,endNodeIndex:ac,innerNodes:N,match:v.text,matchIndex:x}),C-=m.length-ac,w=null,m=null,N=[],v=p.shift(),x++,!v){break}}else{if(q[y.nodeName]&&!G[y.nodeName]||!y.firstChild){if(y.nextSibling){y=y.nextSibling;continue}}else{if(!a(y)){y=y.firstChild;continue}}}for(;;){if(y.nextSibling){y=y.nextSibling;break}if(y.parentNode===S){break a}y=y.parentNode}}}function aa(k){function i(m,p){var o=e[p];o.stencil||(o.stencil=k(o));var l=o.stencil.cloneNode(!1);return l.setAttribute("data-mce-index",p),m&&l.appendChild(R.doc.createTextNode(m)),l}return function(ae){var y,t,N,x=ae.startNode,ah=ae.endNode,ak=ae.matchIndex,E=R.doc;if(x===ah){var aj=x;N=aj.parentNode,ae.startNodeIndex>0&&(y=E.createTextNode(aj.data.substring(0,ae.startNodeIndex)),N.insertBefore(y,aj));var ag=i(ae.match,ak);return N.insertBefore(ag,aj),ae.endNodeIndex<aj.length&&(t=E.createTextNode(aj.data.substring(ae.endNodeIndex)),N.insertBefore(t,aj)),aj.parentNode.removeChild(aj),ag}y=E.createTextNode(x.data.substring(0,ae.startNodeIndex)),t=E.createTextNode(ah.data.substring(ae.endNodeIndex));for(var af=i(x.data.substring(ae.startNodeIndex),ak),ad=[],w=0,S=ae.innerNodes.length;w<S;++w){var C=ae.innerNodes[w],ac=i(C.data,ak);C.parentNode.replaceChild(ac,C),ad.push(ac)}var ai=i(ah.data.substring(0,ae.endNodeIndex),ak);return N=x.parentNode,N.insertBefore(y,x),N.insertBefore(af,x),N.removeChild(x),N=ah.parentNode,N.insertBefore(ai,ah),N.insertBefore(t,ah),N.removeChild(ah),ai}}function I(k){var i=k.parentNode;i.insertBefore(k.firstChild,k),k.parentNode.removeChild(k)}function Q(p){var t=H.getElementsByTagName("*"),m=[];p="number"==typeof p?""+p:null;for(var l=0;l<t.length;l++){var s=t[l],k=s.getAttribute("data-mce-index");null!==k&&k.length&&(k!==p&&null!==p||m.push(s))}return m}function F(k){for(var i=e.length;i--;){if(e[i]===k){return i}}return -1}function Y(k){var i=[];return X(function(m,l){k(m,l)&&i.push(m)}),e=i,this}function X(k){for(var i=0,l=e.length;i<l&&k(e[i],i)!==!1;i++){}return this}function W(i){return e.length&&M(H,e,aa(i)),this}function L(k,i){if(B&&k.global){for(;A=k.exec(B);){e.push(K(A,i))}}return this}function U(k){var i,l=Q(k?F(k):null);for(i=l.length;i--;){I(l[i])}return this}function P(i){return e[i.getAttribute("data-mce-index")]}function V(i){return Q(F(i))[0]}function D(k,i,l){return e.push({start:k,end:k+i,text:B.substr(k,i),data:l}),this}function z(l){var i=Q(F(l)),k=O.dom.createRng();return k.setStartBefore(i[0]),k.setEndAfter(i[i.length-1]),k}function Z(l,i){var k=z(l);return k.deleteContents(),i.length>0&&k.insertNode(O.dom.doc.createTextNode(i)),k}function J(){return e.splice(0,e.length),U(),this}var A,B,G,q,ab,e=[],R=O.dom;return G=O.schema.getBlockElements(),q=O.schema.getWhiteSpaceElements(),ab=O.schema.getShortEndedElements(),B=T(H),{text:B,matches:e,each:X,filter:Y,reset:J,matchFromElement:P,elementFromMatch:V,find:L,add:D,wrap:W,unwrap:U,replace:Z,rangeFromMatch:z,indexOf:F}}}),f("tinymce/spellcheckerplugin/Plugin",["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/PluginManager","tinymce/util/Tools","tinymce/ui/Menu","tinymce/dom/DOMUtils","tinymce/util/XHR","tinymce/util/URI","tinymce/util/JSON"],function(u,m,w,q,l,v,k,p){m.add("spellchecker",function(U,G){function aa(){return K.textMatcher||(K.textMatcher=new u(U.getBody(),U)),K.textMatcher}function Z(A,x){var y=[];return w.each(x,function(B){y.push({selectable:!0,text:B.name,data:B.value})}),y}function Y(y){for(var x in y){return !1}return !0}function P(C,A){var D=[],x=V[C];w.each(x,function(L){D.push({text:L,onclick:function(){U.insertContent(U.dom.encode(L)),U.dom.remove(A),s()}})}),D.push({text:"-"}),O&&D.push({text:"Add to Dictionary",onclick:function(){ab(C,A)}}),D.push.apply(D,[{text:"Ignore",onclick:function(){J(C,A)}},{text:"Ignore all",onclick:function(){J(C,A,!0)}}]),i=new q({items:D,context:"contextmenu",onautohide:function(L){L.target.className.indexOf("spellchecker")!=-1&&L.preventDefault()},onhide:function(){i.remove(),i=null}}),i.renderTo(document.body);var B=l.DOM.getPos(U.getContentAreaContainer()),y=U.dom.getPos(A[0]),E=U.dom.getRoot();"BODY"==E.nodeName?(y.x-=E.ownerDocument.documentElement.scrollLeft||E.scrollLeft,y.y-=E.ownerDocument.documentElement.scrollTop||E.scrollTop):(y.x-=E.scrollLeft,y.y-=E.scrollTop),B.x+=y.x,B.y+=y.y,i.moveTo(B.x,B.y+A[0].offsetHeight)}function W(){return U.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e\xa0\u2002\u2003\u2009]+',"g")}function Q(B,y,A,x){var D={method:B,lang:I.spellchecker_language},C="";D["addToDictionary"==B?"word":"text"]=y,w.each(D,function(L,E){C&&(C+="&"),C+=E+"="+encodeURIComponent(L)}),v.send({url:new k(G).toAbsolute(I.spellchecker_rpc_url),type:"post",content_type:"application/x-www-form-urlencoded",data:C,success:function(L){if(L=p.parse(L)){L.error?x(L.error):A(L)}else{var E=U.translate("Server response wasn't proper JSON.");x(E)}},error:function(){var E=U.translate("The spelling service was not found: (")+I.spellchecker_rpc_url+U.translate(")");x(E)}})}function X(B,y,C,A){var x=I.spellchecker_callback||Q;x.call(K,B,y,C,A)}function F(){function x(y){U.notificationManager.open({text:y,type:"error"}),U.setProgressState(!1),t()}t()||(U.setProgressState(!0),X("spellcheck",aa().text,ac,x),U.focus())}function s(){U.dom.select("span.mce-spellchecker-word").length||t()}function ab(y,x){U.setProgressState(!0),X("addToDictionary",y,function(){U.setProgressState(!1),U.dom.remove(x,!0),s()},function(A){U.notificationManager.open({text:A,type:"error"}),U.setProgressState(!1)})}function J(A,x,y){U.selection.collapse(),y?w.each(U.dom.select("span.mce-spellchecker-word"),function(B){B.getAttribute("data-mce-word")==A&&U.dom.remove(B,!0)}):U.dom.remove(x,!0),s()}function t(){if(aa().reset(),K.textMatcher=null,a){return a=!1,U.fire("SpellcheckEnd"),!0}}function z(y){var x=y.getAttribute("data-mce-index");return"number"==typeof x?""+x:x}function H(B){var y,A=[];if(y=w.toArray(U.getBody().getElementsByTagName("span")),y.length){for(var x=0;x<y.length;x++){var C=z(y[x]);null!==C&&C.length&&C===B.toString()&&A.push(y[x])}}return A}function n(y){var x=I.spellchecker_language;y.control.items().each(function(A){A.active(A.settings.data===x)})}function ac(y){var x;if(y.words?(O=!!y.dictionary,x=y.words):x=y,U.setProgressState(!1),Y(x)){var A=U.translate("No misspellings found.");return U.notificationManager.open({text:A,type:"info"}),void (a=!1)}V=x,aa().find(W()).filter(function(B){return !!x[B.text]}).wrap(function(B){return U.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":B.text})}),a=!0,U.fire("SpellcheckStart")}var e,V,a,i,O,K=this,I=U.settings;if(/(^|[ ,])tinymcespellchecker([, ]|$)/.test(I.plugins)&&m.get("tinymcespellchecker")){return void ("undefined"!=typeof console&&console.log&&console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."))}var r=I.spellchecker_languages||"English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";e=Z("Language",w.map(r.split(","),function(x){return x=x.split("="),{name:x[0],value:x[1]}})),U.on("click",function(A){var x=A.target;if("mce-spellchecker-word"==x.className){A.preventDefault();var B=H(z(x));if(B.length>0){var y=U.dom.createRng();y.setStartBefore(B[0]),y.setEndAfter(B[B.length-1]),U.selection.setRng(y),P(x.getAttribute("data-mce-word"),B)}}}),U.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:F,selectable:!0,onPostRender:function(){var x=this;x.active(a),U.on("SpellcheckStart SpellcheckEnd",function(){x.active(a)})}});var o={tooltip:"Spellcheck",onclick:F,onPostRender:function(){var x=this;U.on("SpellcheckStart SpellcheckEnd",function(){x.active(a)})}};e.length>1&&(o.type="splitbutton",o.menu=e,o.onshow=n,o.onselect=function(x){I.spellchecker_language=x.control.settings.data}),U.addButton("spellchecker",o),U.addCommand("mceSpellCheck",F),U.on("remove",function(){i&&(i.remove(),i=null)}),U.on("change",s),this.getTextMatcher=aa,this.getWordCharPattern=W,this.markErrors=ac,this.getLanguage=function(){return I.spellchecker_language},I.spellchecker_language=I.spellchecker_language||I.language||"en"})}),h(["tinymce/spellcheckerplugin/DomTextMatcher"])}(window);