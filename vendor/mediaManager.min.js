function MediaManager(a){this.files=[];this.config={manager:"images"};this.parameters=a;this.applyParameters();this.start()}MediaManager.prototype.applyParameters=function(){let allowedParameters=["manager","callback","onSelect"];for(let i in this.parameters){if(allowedParameters.indexOf(i)===-1){continue}this.config[i]=this.parameters[i]}};MediaManager.prototype.start=function(){$("div.media-manager").addClass("show");if("onSelect" in this.config){let mediaManagerElement=$("div.media-manager");let selectEvent=function(a){mediaManagerElement.off("click","li.item-file input");if(a.target.parentNode.getAttribute("data-type")!==this.config.manager){return false}let name=a.target.parentNode.innerText;this.config.onSelect(name.trim())}.bind(this);mediaManagerElement.on("click","li.item-file input",selectEvent)}};MediaManager.prototype.addFile=function(a){document.querySelector("div.manager-queue").classList.add("show");let newFile={name:a.name,size:a.size,type:a.type};let type=a.type.split("/")[0];let formData=new FormData();formData.append("file",a);newFile.data=formData;let itemElement=document.createElement("div");itemElement.classList.add("queue-item");let iconElement=document.createElement("div");iconElement.classList.add("type-icon");iconElement.classList.add("icon-"+type+"_white");let nameElement=document.createElement("p");nameElement.classList.add("item-name");nameElement.innerText=newFile.name;let removeElement=document.createElement("span");removeElement.classList.add("remove-item");removeElement.classList.add("icon-close_white");let uploadElement=document.createElement("span");uploadElement.classList.add("upload-item");uploadElement.setAttribute("data-locale","UPLOAD");uploadElement.innerText=translate.locale.admin_header.UPLOAD;itemElement.appendChild(iconElement);itemElement.appendChild(nameElement);itemElement.appendChild(removeElement);itemElement.appendChild(uploadElement);document.querySelector("div.manager-queue-list").appendChild(itemElement);document.querySelector("div.manager-queue").classList.remove("minimize");this.files.push(newFile)};MediaManager.prototype.removeFile=function(a){let pos=-1;for(let i=0;i<this.files.length;++i){if(this.files[i].name==a){pos=i}}this.files.splice(pos,1)};MediaManager.prototype.uploadFile=function(a){let pos=-1;for(let i=0;i<this.files.length;++i){if(this.files[i].name==a){pos=i}}let fileData=this.files[pos];fileData.data.append("csrf_token",document.querySelector("meta[name=csrf_token]").getAttribute("content"));let result=false;$.ajax({method:"POST",url:"?route="+$("meta[name=route]").attr("content")+"/mediaManager/upload",async:false,data:fileData.data,cache:false,processData:false,contentType:false,success:function(b){this.files.splice(pos,1);result=true}.bind(this),error:function(b){result=false}.bind(this)});setTimeout(function(){managerActiveInstance.updateFiles()},500);return result};MediaManager.prototype.updateFiles=function(){$.ajax({method:"POST",url:"?route="+$("meta[name=route]").attr("content")+"/mediaManager/filelist",async:true,data:{csrf_token:document.querySelector("meta[name=csrf_token]").getAttribute("content")},success:function(a){$("div.manager-content").html(a)}})};let managerActiveInstance;$.ajax({method:"GET",url:"?route="+$("meta[name=route]").attr("content")+"/mediaManager&csrf_token="+document.querySelector("meta[name=csrf_token]").getAttribute("content"),async:false,success:function(a){document.querySelector("body").insertAdjacentHTML("beforeend",a);$("button.manager-upload-image").click(function(){$("input[name=media_manager_input_image]").click()});$("button.manager-upload-video").click(function(){$("input[name=media_manager_input_video]").click()});$("button.manager-upload-audio").click(function(){$("input[name=media_manager_input_audio]").click()});$("button.manager-upload-file").click(function(){$("input[name=media_manager_input_file]").click()});$("input[name=media_manager_input_image]").change(function(b){managerActiveInstance.addFile(b.target.files[0])});$("input[name=media_manager_input_video]").change(function(b){managerActiveInstance.addFile(b.target.files[0])});$("input[name=media_manager_input_audio]").change(function(b){managerActiveInstance.addFile(b.target.files[0])});$("input[name=media_manager_input_file]").change(function(b){managerActiveInstance.addFile(b.target.files[0])});$("div.media-manager span.close-manager").click(function(){let mediaManagerElement=$("div.media-manager");mediaManagerElement.removeClass("show");mediaManagerElement.off("click","li.item-file input")});$("div.manager-queue-header").click(function(){$("div.manager-queue").toggleClass("minimize")});let html=$("html");html.on("click","div.queue-item span.remove-item",function(b){let fileName=b.target.parentNode.querySelector("p").innerText;managerActiveInstance.removeFile(fileName);let element=b.target.parentNode;element.parentNode.removeChild(element)});html.on("click","div.queue-item span.upload-item",function(b){document.querySelector("div.manager-queue").classList.add("loading");let fileName=b.target.parentNode.querySelector("p").innerText;if(managerActiveInstance.uploadFile(fileName)){let element=b.target.parentNode;element.parentNode.removeChild(element)}setTimeout(function(){document.querySelector("div.manager-queue").classList.remove("loading")},600)})}});