function Loader(a){this.previous={link:"",target:"content"};this.link="";this.target="";this.eventCounter=0;this.config={domain:"admin",csrf:"",root:"",targets:{content:"body",subcontent:"body",full:"html"}};this.parameters=a;this.applyParameters();this.core();if("callback" in this.config){this.config.callback(this.config.domain)}}Loader.prototype.applyParameters=function(){let allowedParameters=["domain","callback","csrf","root","targets","onStart","onError","onDone"];for(let i in this.parameters){if(allowedParameters.indexOf(i)===-1){continue}this.config[i]=this.parameters[i]}};Loader.prototype.core=function(){this.createEvents()};Loader.prototype.createEvents=function(){let links=document.querySelectorAll("[data-link]");for(let i=0;i<links.length;++i){links[i].onclick=function(){if("onStart" in this.config){this.config.onStart()}let link=links[i].getAttribute("data-link");let target=links[i].getAttribute("data-target");this.executeEvent(link,target)}.bind(this);links[i].onmouseup=function(a){if(a.which===2){if("onStart" in this.config){this.config.onStart()}let link=links[i].getAttribute("data-link");this.executeEvent(link,"blank");a.preventDefault()}}.bind(this)}};Loader.prototype.executeEvent=function(a,b){if(this.eventCounter===0){this.saveCurrentState("","content")}this.link=a;this.target=b;if(this.target==="blank"){this.openNewTab();this.config.onDone(false,this.link,true);return true}this.getContent()};Loader.prototype.openNewTab=function(){let newTab=window.open(this.config.root+this.link,"_blank");newTab.location};Loader.prototype.saveCurrentState=function(a,b){let title=document.querySelector("title").getAttribute("data-locale");if(this.config.root.slice(-1)!=="/"){this.config.root+="/"}window.history.pushState({title:title,link:a,target:b},"",this.config.root+a);++this.eventCounter};Loader.prototype.getContent=function(){let link=this.link;if(this.config.csrf!==""){let csrf=document.querySelector('meta[name="'+this.config.csrf+'"]').getAttribute("content");link=this.config.root+this.link+"&"+this.config.csrf+"="+csrf}let url=link;let ajaxRequest=new XMLHttpRequest;ajaxRequest.onload=function(){this.handleContent(ajaxRequest)}.bind(this);ajaxRequest.open("GET",url);ajaxRequest.setRequestHeader("X-Requested-With","XMLHttpRequest");ajaxRequest.send()};Loader.prototype.handleContent=function(a){let status=a.status;let content=a.responseText;if(status!==200){if("onError" in this.config){this.config.onError(status)}}try{let result=JSON.parse(content);if("onError" in this.config){this.config.onError(result.code)}}catch(b){this.renderContent(content)}};Loader.prototype.renderContent=function(a){let element=document.querySelector(this.config.targets[this.target]);element.remove();let body=document.querySelector("body");body.insertAdjacentHTML("beforeend",a);this.saveCurrentState(this.link,this.target);this.createEvents();if("onDone" in this.config){this.config.onDone(a,this.link)}};