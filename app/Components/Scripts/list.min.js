componentsModule.modules.list={data:{},itemClone:false,validate:function(){return true},serialize:function(){return componentsModule.modules.list.data},reloadItems:function(a,b){let newOrder=[];let newContent=[];let newChecked=[];b.querySelectorAll(".list-item").forEach(function(d,c){newOrder.push(parseFloat(d.getAttribute("data-item")));d.querySelector(".item-number").innerText=+c+1+".";let text=d.querySelector("p").innerText.trim();if(text===componentsModule.modules.list.itemClone.querySelector("p").innerText.trim()){text=""}newContent.push(text);newChecked.push(d.querySelector(".item-check").classList.contains("checked"))});componentsModule.modules.list.data[a].list=newContent;componentsModule.modules.list.data[a].list_checked=newChecked;componentsModule.modules.list.data[a].order=newOrder},createItem:function(b,c,d,a){let itemID=Math.random()*(99999-10000)+10000;let index;if(!d){componentsModule.modules.list.data[b].list.push("");componentsModule.modules.list.data[b].list_checked.push(false);componentsModule.modules.list.data[b].order.push(itemID);index=+componentsModule.modules.list.data[b].order.indexOf(itemID)}else{index=+componentsModule.modules.list.data[b].order.indexOf(d);if(index===-1){return false}index+=1;componentsModule.modules.list.data[b].list.splice(index,0,"");componentsModule.modules.list.data[b].list_checked.splice(index,0,false);componentsModule.modules.list.data[b].order.splice(index,0,itemID)}let itemElement=componentsModule.modules.list.itemClone.cloneNode(true);itemElement.setAttribute("data-item",itemID.toString());itemElement.querySelector(".item-number").innerText=+index+1+".";let itemText=itemElement.querySelector("p");componentsModule.initializeEvents([{event:"click",element:itemElement.querySelector(".item-check"),content:function(e){e.target.classList.toggle("checked");let index=componentsModule.modules.list.data[b].order.indexOf(itemID);componentsModule.modules.list.data[b].list_checked[index]=e.target.classList.contains("checked")}},{event:"focus",element:itemText,content:function(e){if(e.target.innerText.trim()!==componentsModule.modules.list.itemClone.querySelector("p").innerText){return false}e.target.classList.remove("item-text-placeholder");e.target.innerText=""}},{event:"blur",element:itemText,content:function(e){if(!componentsModule.modules.list.data[b].order[index+1]&&e.target.innerText.trim()!==""){componentsModule.modules.list.createItem(b,c,itemID)}if(e.target.innerText.trim()!==""){return false}e.target.classList.add("item-text-placeholder");e.target.innerText=componentsModule.modules.list.itemClone.querySelector("p").innerText}},{event:"keydown",element:itemText,content:function(e){if(e.keyCode!==13){return false}if(!componentsModule.modules.list.data[b].order[index+1]&&e.target.innerText.trim()!==""){componentsModule.modules.list.createItem(b,c,itemID,true)}else{if(e.shiftKey){if(!(!itemElement.previousSibling)){itemElement.previousSibling.querySelector("p").focus()}}else{if(!(!itemElement.nextSibling)){itemElement.nextSibling.querySelector("p").focus()}}}e.preventDefault()}},{event:"keyup change",element:itemText,content:function(e){componentsModule.modules.list.data[b].list[index]=e.target.innerText.trim()}},{event:"click",element:itemElement.querySelector(".list-item-delete"),content:function(){if(c.children.length<2){return false}let index=componentsModule.modules.list.data[b].order.indexOf(itemID);if(index===-1){return false}componentsModule.modules.list.data[b].list.splice(index,1);componentsModule.modules.list.data[b].order.splice(index,1);componentsModule.modules.list.data[b].list_checked.splice(index,1);c.removeChild(itemElement);componentsModule.modules.list.reloadItems(b,c)}}]);if(!d){c.appendChild(itemElement)}else{if(!componentsModule.modules.list.data[b].order[index+1]){c.appendChild(itemElement)}else{c.insertBefore(itemElement,c.children[index+1])}}if(a){itemText.focus()}},create:function(a,b){let contentElement=b.querySelector(".component-element-content");let listElement=contentElement.querySelector(".component-inline-list-content");let listItem=listElement.querySelector(".list-item");if(!componentsModule.modules.list.itemClone){componentsModule.modules.list.itemClone=listItem.cloneNode(true)}listElement.removeChild(listItem);componentsModule.modules.list.data[a]={title:"",disabled:0,list:[],order:[],list_checked:[],list_title:"",list_type:0,list_position:1};Sortable.create(listElement,{sort:true,animation:200,scroll:false,draggable:".list-item",handle:".list-item-move",onStart:function(c){c.item.classList.add("chosen")},onEnd:function(c){c.item.classList.remove("chosen");componentsModule.modules.list.reloadItems(a,listElement)}});let typeItems=contentElement.querySelectorAll(".component-list_type .position-item");let positionItems=contentElement.querySelectorAll(".component-list_align .position-item");componentsModule.initializeEvents([{event:"change keyup",element:contentElement.querySelector("input[name=component_inline_list_name]"),content:function(c){componentsModule.modules.list.data[a].list_title=c.target.value.trim()}},{event:"click",element:typeItems,content:function(c){listElement.setAttribute("data-type",componentsModule.modules.list.data[a].list_type=c.target.getAttribute("data-position"));typeItems.forEach(function(d){d.classList.remove("active")});c.target.classList.add("active")}},{event:"click",element:positionItems,content:function(c){componentsModule.modules.list.data[a].list_position=c.target.getAttribute("data-position");positionItems.forEach(function(d){d.classList.remove("active")});c.target.classList.add("active")}}]);componentsModule.modules.list.createItem(a,listElement)}};