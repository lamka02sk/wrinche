componentsModule.modules.picture={data:{},elements:{},start:function(){let current=componentsModule.modules.picture;current.templateElement=contentElement.querySelector("#template_component_content_picture_image").children[0]},resumeInline:function(b,c,a){let current=componentsModule.modules.picture;let path=a.picture;current.create(b,c);current.onSelect(b,c,path,true,function(d,e){d.value=a.picture_description.trim();triggerEvent(d,"change");e[a.picture_align].click()})},validateInput:function(c,a,d,b){console.log("validation");let current=componentsModule.modules.picture;let elements=current.elements[a];if(!validateUrl(c)){return showValidationResult(elements.messageBox,"COMPONENT_URL_INVALID",false,reloadPackery)}new Promise(function(e){let image=new Image;image.onload=function(){e(true)};image.onerror=function(){e(false)};image.src=c}).then(function(e){if(e){showValidationResult(elements.messageBox,"COMPONENT_URL_INVALID",true,reloadPackery);if(d){d()}}else{showValidationResult(elements.messageBox,"COMPONENT_URL_INVALID",false,reloadPackery);if(b){b()}}})},removeCurrent:function(a){let instance=a.querySelector("div.component-instance span.picture-remove");if(instance){instance.click()}},onSelect:function(a,b,d,c,e){let current=componentsModule.modules.picture;let elements=current.elements[a];elements.contentElement.classList.add("no-padding");current.removeCurrent(b);if(!c){d="app/Data/Files/Images/"+d}current.data[a]={title:"",picture:d,picture_description:"",picture_align:1,disabled:0};let template=current.templateElement.cloneNode(true);template.setAttribute("data-path",d);template.classList.add("component-instance");template.children[0].setAttribute("src",d);template.children[0].setAttribute("alt",d);elements.contentElement.appendChild(template);template.children[0].addEventListener("load",function(){closeMediaManager();elements.inputBox.classList.add("hide")});let alignOptions=template.children[3].children;componentsModule.initializeEvents([{event:"change keyup",element:template.children[2],content:function(f){current.data[a].picture_description=f.target.value.trim()}},{event:"click",element:alignOptions,content:function(f){current.data[a].picture_align=+f.target.getAttribute("data-value");Object.values(alignOptions).forEach(function(g){g.classList.remove("active")});f.target.classList.add("active")}}]);template.children[1].addEventListener("click",function(){elements.inputBox.classList.remove("hide");elements.contentElement.removeChild(template);elements.contentElement.classList.remove("no-padding");delete current.data[a]});if(e){e(template.children[2],alignOptions)}},create:function(a,b){let current=componentsModule.modules.picture;current.elements[a]={};let elements=current.elements[a];elements.parentElement=b;elements.contentElement=b.querySelector("div.component-element-content");elements.inputBox=elements.contentElement.querySelector("div.input-box.select-image");elements.messageBox=elements.inputBox.querySelector(".validate-message");componentsModule.initializeEvents([{event:"click",element:b.querySelector("button.inline-image_manager"),content:function(){managerActiveInstance=new MediaManager({manager:"images",onSelect:function(c){current.onSelect(a,b,c,false)}})}},{event:"keypress",element:b.querySelector("input[name=component_inline_picture_input]"),content:function(c){if(!c.keyCode||c.keyCode!==13){return false}let path=c.target.value.trim();current.validateInput(path,a,function(){current.onSelect(a,b,path,true)})}},{event:"change keyup",element:b.querySelector("input[name=component_inline_picture_input]"),content:function(c){current.validateInput(c.target.value.trim(),a)}}])},validate:function(){return true},serialize:function(){return componentsModule.modules.picture.data}};