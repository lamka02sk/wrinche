componentsModule.modules.attachments={start:function(){let current=componentsModule.modules.attachments;current.parentElement=document.querySelector("[data-component=attachments]");current.listElement=current.parentElement.querySelector(".attachments-list");current.templateElement=current.parentElement.querySelector("#template_component_attachments_added").childNodes[0];componentsModule.initializeEvent({event:"click",element:current.parentElement,content:function(a){if(a.target.matches(".add-attachment")){let type=a.target.getAttribute("data-content");managerActiveInstance=new MediaManager({manager:type,onSelect:function(b){current.addNew(b,type)}})}else{if(a.target.matches(".attachment-remove")){current.listElement.removeChild(a.target.parentNode);reloadPackery()}}}})},resume:function(){let current=componentsModule.modules.attachments;const b=current.parentElement.getAttribute("data-resume");if(b===""){return true}const a=JSON.parse(b).attachments;if(a===null){return true}const c=["images","videos","sounds","files"];const d=["app/Data/Files/Images/","app/Data/Files/Videos/","app/Data/Files/Sounds/","app/Data/Files/Files/"];Array.from(a).forEach(function(f){const e=d.findIndex(function(g){return ~f.indexOf(g)});f=f.replace(d[e],"");current.addNew(f,c[e])})},isDuplicate:function(a){return ~componentsModule.modules.attachments.serialize().attachments.indexOf(a)},addNew:function(c,b){const a={images:["Images","image"],videos:["Videos","video"],sounds:["Sounds","audio"],files:["Files","file"]};let current=componentsModule.modules.attachments;let pathPrefix="app/Data/Files/";let fileType=a[b][1];let text=c;c=pathPrefix+a[b][0]+"/"+c;if(current.isDuplicate(c)){return closeMediaManager()}let template=current.templateElement.cloneNode(true);template.classList.add("component-instance");template.setAttribute("data-path",c);template.classList.add("icon-"+fileType);template.childNodes[1].innerText=text;current.listElement.insertBefore(template,current.listElement.childNodes[0]);closeMediaManager();reloadPackery()},validate:function(){return true},serialize:function(){let attachmentsElements=componentsModule.modules.attachments.listElement.childNodes;let attachmentsList=Array.from(attachmentsElements).reverse().map(function(a){return a.getAttribute("data-path")});return{attachments:attachmentsList}}};