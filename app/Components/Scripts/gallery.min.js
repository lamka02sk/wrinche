componentsModule.modules.gallery={data:{},valid:{},validate:function(){return true},serialize:function(){return componentsModule.modules.gallery.data},validateInput:function(a,b,c,d){if(!/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/.test(c)){showValidationResult(b,"COMPONENT_URL_INVALID",false,$.noop);return false}let promise=new Promise(function(f,e){let image=new Image;image.onload=function(){f(true)};image.onerror=function(){f(false)};image.src=c});promise.then(function(e){if(e){showValidationResult(b,"",true,$.noop);if(d){d(a,b,c,true)}return true}showValidationResult(b,"COMPONENT_URL_INVALID",false,$.noop)})},onSelect:function(a,b,d,c){let contentElement=b.querySelector("div.gallery-items");contentElement.classList.remove("no-padding");if(!c){d="app/Data/Files/Images/"+d}if(componentsModule.modules.gallery.data[a]){componentsModule.modules.gallery.data[a].gallery.push(d)}else{componentsModule.modules.gallery.data[a]={title:"",gallery:[d],valid:true,disabled:0}}let template=b.querySelector("#template_component_gallery_item").children[0].cloneNode(true);template.setAttribute("data-path",d);template.classList.add("component-instance");template.children[0].children[0].setAttribute("src",d);template.children[0].children[0].setAttribute("alt",d);template.children[1].addEventListener("click",function(){contentElement.removeChild(template);for(let i=0;i<componentsModule.modules.gallery.data[a].gallery.length;++i){if(componentsModule.modules.gallery.data[a].gallery[i]===d){componentsModule.modules.gallery.data[a].gallery.splice(i,1)}}});contentElement.appendChild(template);if(!c){document.querySelector("div.media-manager span.close-manager").click()}},create:function(a,b){componentsModule.initializeEvents([{event:"click",element:b.querySelector("button.inline-image_manager"),content:function(){managerActiveInstance=new MediaManager({manager:"images",onSelect:function(c){componentsModule.modules.gallery.onSelect(a,b,c,false)}})}},{event:"keypress",element:b.querySelector("input[name=component_inline_picture_input]"),content:function(c){if(c.keyCode&&c.keyCode===13){let path=c.target.value.trim();componentsModule.modules.gallery.validateInput(a,b,path,componentsModule.modules.gallery.onSelect)}}},{event:"change keyup",element:b.querySelector("input[name=component_inline_picture_input]"),content:function(c){componentsModule.modules.gallery.validateInput(a,b,c.target.value.trim())}}])}};