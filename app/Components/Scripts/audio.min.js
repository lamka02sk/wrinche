componentsModule.modules.audio={data:{},valid:{},showError:function(b,a){let messageElement=b.querySelector("span.field-validation");messageElement.setAttribute("data-locale","COMPONENT_URL_INVALID");messageElement.innerText=translate.locale.components.COMPONENT_URL_INVALID;messageElement.classList.add("show");componentsModule.modules.audio.valid[a]={valid:false}},hideError:function(b,a){let messageElement=b.querySelector("span.field-validation");messageElement.classList.remove("show");componentsModule.modules.audio.valid[a]={valid:true}},validateInput:function(b,a,c){if(!/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/.test(c)){componentsModule.modules.audio.showError(b,a);return false}let promise=new Promise(function(e,d){let audio=new Audio;audio.addEventListener("canplaythrough",function(){e(true)});audio.addEventListener("error",function(){e(false)});audio.src=c});promise.then(function(d){if(d){componentsModule.modules.audio.hideError(b,a)}else{componentsModule.modules.audio.showError(b,a)}})},remove:function(a){a.querySelectorAll("div.component-instance").forEach(function(b){b.querySelector("span.item-remove").click()})},onSelect:function(a,b,d,c){let contentElement=b.querySelector("div.component-element-content");contentElement.classList.add("no-padding");componentsModule.modules.audio.remove(b);if(!c){d="app/Data/Files/Sounds/"+d}componentsModule.modules.audio.data[a]={title:"",audio:d,disabled:0};let template=contentElement.querySelector("#template_component_content_audio_item").children[0].cloneNode(true);template.setAttribute("data-path",d);template.classList.add("component-instance");template.children[0].setAttribute("src",d);template.children[3].innerText=d.split("/").pop();contentElement.appendChild(template);let timer;template.children[1].addEventListener("click",function(f){if(template.children[0].ended){template.children[2].click()}if(template.children[0].paused){template.children[0].play();e();timer=setInterval(e,1000)}else{template.children[0].pause();e();clearInterval(timer)}f.target.classList.toggle("icon-pause")});template.children[2].addEventListener("click",function(){template.children[0].currentTime=0;template.children[0].pause();template.children[1].classList.remove("icon-pause");clearInterval(timer);e()});function e(){let position=template.children[0].currentTime;position=parseInt(position/60,10)+":"+pad(Math.round(position%60),2);let duration=template.children[0].duration;let minutes=parseInt(duration/60,10);let seconds=duration%60;template.children[5].innerText=position+"/"+minutes+":"+pad(Math.round(seconds),2)}template.children[0].addEventListener("loadedmetadata",function(){e();contentElement.querySelector("div.input-box.select-image").classList.add("hide");document.querySelector("div.media-manager span.close-manager").click()});template.children[4].addEventListener("click",function(){contentElement.querySelector("div.input-box.select-image").classList.remove("hide");contentElement.removeChild(template);contentElement.classList.remove("no-padding");delete componentsModule.modules.audio.data[a]})},create:function(a,b){componentsModule.initializeEvents([{event:"click",element:b.querySelector("button.inline-image_manager"),content:function(){managerActiveInstance=new MediaManager({manager:"sounds",onSelect:function(c){componentsModule.modules.audio.onSelect(a,b,c,false)}})}},{event:"keypress",element:b.querySelector("input[name=component_inline_audio_input]"),content:function(c){if(c.keyCode&&c.keyCode===13){let path=c.target.value;componentsModule.modules.audio.validateInput(b,a,path);if(componentsModule.modules.audio.valid[a].valid){componentsModule.modules.audio.onSelect(a,b,path,true)}}}},{event:"change keyup",element:b.querySelector("input[name=component_inline_audio_input]"),content:function(c){componentsModule.modules.audio.validateInput(b,a,c.target.value)}}])},validate:function(){return true},serialize:function(){return componentsModule.modules.audio.data}};